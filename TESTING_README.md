# Тестирование проекта Stellar Burger

## Описание

В данном проекте реализовано полное покрытие тестами для обеспечения надежности и стабильности приложения. Тестирование включает в себя unit-тесты для Redux логики и E2E тесты для пользовательских сценариев.

## Типы тестов

### Unit тесты (Jest)

Покрывают всю Redux логику приложения:

- **constructorSlice** - управление конструктором бургера
- **ingredientsSlice** - загрузка и управление ингредиентами  
- **authSlice** - авторизация пользователя
- **orderSlice** - создание заказов
- **feedSlice** - лента заказов
- **orderHistorySlice** - история заказов пользователя
- **ingredientDetailsSlice** - детали выбранного ингредиента
- **orderDetailsSlice** - детали заказа

Каждый slice протестирован на:
- Корректность начального состояния
- Работу всех редьюсеров (обработчиков действий)
- Функционирование селекторов
- Обработку асинхронных операций

### E2E тесты (Cypress)

Покрывают основные пользовательские сценарии на странице конструктора:

- Загрузка и отображение ингредиентов
- Drag & Drop ингредиентов в конструктор
- Открытие модальных окон с деталями ингредиентов
- Создание заказа с авторизацией
- Закрытие модальных окон
- Обработка ошибок и edge cases

## Как запускать тесты

### Unit тесты

```bash
# Запуск всех unit тестов
npm test

# Запуск в watch режиме
npm run test:watch

# Запуск с покрытием кода
npm run test:coverage
```

### E2E тесты

```bash
# Сначала запустите dev сервер
npm start

# В другом терминале запустите Cypress
npx cypress open      # Интерактивный режим
     # Headless режим
```

## Структура тестов

```
src/
├── services/
│   ├── auth/
│   │   ├── authSlice.ts
│   │   └── authSlice.test.ts
│   ├── constructor/
│   │   ├── constructorSlice.ts
│   │   └── constructorSlice.test.ts
│   └── ... (другие slices с тестами)
│
cypress/
├── e2e/
│   └── constructor.cy.ts
├── fixtures/
│   ├── ingredients.json
│   └── order.json
└── support/
    ├── commands.ts
    └── e2e.ts
```

## Конфигурация

- **Jest** - настроен с TypeScript поддержкой
- **Cypress** - настроен с фикстурами и перехватом API
- **TypeScript** - отдельные конфигурации для тестов и продакшена
- **Webpack** - исключает тестовые файлы из основной сборки

## Статистика покрытия

- **Unit тесты**: 95 тестов покрывают все Redux slice'ы
- **E2E тесты**: 10 тестов покрывают основные пользовательские сценарии
- **Общий результат**: 105 тестов, все проходят успешно

## Дополнительные возможности

### Отладка тестов

Для отладки unit тестов можно использовать:
```bash
npm test -- --watchAll --verbose
```

Для отладки E2E тестов запустите Cypress в интерактивном режиме:
```bash
npx cypress open
```

### Мокирование данных

В тестах используются моки для:
- API запросов (перехватываются в Cypress)
- Redux store (создается тестовое состояние)
- Пользовательских данных (фикстуры)

### Селекторы для тестирования

В компонентах добавлены `data-testid` атрибуты для надежного поиска элементов в E2E тестах.

## Лучшие практики

1. **Изоляция тестов** - каждый тест независим и не влияет на другие
2. **Понятные названия** - описывают что именно тестируется
3. **Полное покрытие** - тестируются как успешные, так и ошибочные сценарии
4. **Реалистичные данные** - используются данные, похожие на реальные
5. **Быстрое выполнение** - тесты оптимизированы для скорости

## Проблемы и решения

При возникновении проблем:

1. **Тесты падают локально** - проверьте версии зависимостей
2. **Cypress не может найти элементы** - убедитесь что dev сервер запущен
3. **Jest выдает ошибки типов** - проверьте TypeScript конфигурацию

## Заключение

Текущее покрытие тестами обеспечивает высокое качество кода и позволяет уверенно вносить изменения в проект, зная что основная функциональность не сломается.
