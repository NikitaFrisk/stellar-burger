"use strict";(self.webpackChunkreact_webpack_starter=self.webpackChunkreact_webpack_starter||[]).push([[257],{8123:(e,r,d)=>{d.d(r,{B:()=>t});var s=d(4848),a=d(3231);var t=function(e){var r,d,t,n,o,c,l=e.order,i=e.ingredients,_=e.showStatus,u=void 0===_||_,m=e.onClick,h=l.ingredients.map((function(e){return i.find((function(r){return r._id===e}))})).filter(Boolean),x=h.reduce((function(e,r){return e+r.price}),0),f=h.slice(0,6),j=h.length-6;return(0,s.jsxs)("div",{className:"order-card-module__orderCard__kTURt",onClick:m,children:[(0,s.jsxs)("div",{className:"order-card-module__orderHeader__xEdQV",children:[(0,s.jsx)("span",{className:"order-card-module__orderId__pAzuR",children:(c=l.number,"#".concat(c.toString().padStart(6,"0")))}),(0,s.jsx)("span",{className:"order-card-module__timestamp__CV6pp",children:(r=l.createdAt,d=new Date(r),t=(new Date).getTime()-d.getTime(),n=Math.floor(t/864e5),o=d.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),0===n?"Сегодня, ".concat(o):1===n?"Вчера, ".concat(o):n<=7?"".concat(n," дня назад, ").concat(o):d.toLocaleDateString("ru-RU")+", ".concat(o))})]}),(0,s.jsxs)("div",{className:"order-card-module__orderInfo__YP8ZK",children:[(0,s.jsx)("h3",{className:"order-card-module__burgerName__I1HhJ",children:l.name}),u&&(0,s.jsx)("div",{className:"".concat("order-card-module__status__MPbjR"," ").concat(function(e){switch(e){case"done":return"order-card-module__statusDone__x57cz";case"pending":return"order-card-module__statusPending__MjwBg";case"created":return"order-card-module__statusCreated__fwnQK";default:return""}}(l.status)),children:function(e){switch(e){case"done":return"Выполнен";case"pending":return"Готовится";case"created":return"Создан";default:return""}}(l.status)})]}),(0,s.jsxs)("div",{className:"order-card-module__orderFooter__YSgop",children:[(0,s.jsx)("div",{className:"order-card-module__ingredients__Ow5aa",children:f.map((function(e,r){var d=5===r&&j>0;return(0,s.jsxs)("div",{className:"order-card-module__ingredientPreview__ab8hz",style:{zIndex:6-r},children:[(0,s.jsx)("img",{src:e.image,alt:e.name,className:"order-card-module__ingredientImage__qn5x8"}),d&&(0,s.jsx)("div",{className:"order-card-module__moreOverlay__c3erX",children:(0,s.jsxs)("span",{className:"order-card-module__moreCount__Iv9uW",children:["+",j]})})]},e._id+r)}))}),(0,s.jsxs)("div",{className:"order-card-module__price__PAdlT",children:[(0,s.jsx)("span",{className:"order-card-module__priceValue__ReBGy",children:x}),(0,s.jsx)("div",{className:"order-card-module__priceIcon__PvLbe",children:(0,s.jsx)(a.px,{type:"primary"})})]})]})]})}},9257:(e,r,d)=>{d.r(r),d.d(r,{FeedPage:()=>u});var s=d(4848),a=d(6540),t=d(7767),n=d(8123);var o=function(e){var r=e.doneOrders,d=e.pendingOrders,a=e.totalCompleted,t=e.todayCompleted,n=function(e){return e.toLocaleString("ru-RU")},o=function(e){return e.toString().padStart(6,"0")};return(0,s.jsxs)("div",{className:"order-stats-module__stats__JDrLg",children:[(0,s.jsxs)("div",{className:"order-stats-module__ordersBoard__QAjgw",children:[(0,s.jsxs)("div",{className:"order-stats-module__doneOrders__f02SP",children:[(0,s.jsx)("h3",{className:"order-stats-module__doneTitle__K9pwm",children:"Готовы:"}),(0,s.jsx)("div",{className:"order-stats-module__doneOrdersList__idE4q",children:r.slice(0,20).map((function(e,r){return(0,s.jsx)("div",{className:"order-stats-module__doneOrderNumber__DsaIx",style:{order:r},children:o(e)},e)}))})]}),(0,s.jsxs)("div",{className:"order-stats-module__inWorkOrders__eP1Mn",children:[(0,s.jsx)("h3",{className:"order-stats-module__inWorkTitle__Vh7Hp",children:"В работе:"}),(0,s.jsx)("div",{className:"order-stats-module__inWorkOrdersList__aDgVV",children:d.slice(0,20).map((function(e,r){return(0,s.jsx)("div",{className:"order-stats-module__inWorkOrderNumber__zggyT",style:{order:r},children:o(e)},e)}))})]})]}),(0,s.jsxs)("div",{className:"order-stats-module__completedAllTime__lKeQo",children:[(0,s.jsx)("h3",{className:"order-stats-module__allTimeTitle__RhKYB",children:"Выполнено за все время:"}),(0,s.jsx)("div",{className:"order-stats-module__allTimeNumber__DXeaS",children:n(a)})]}),(0,s.jsxs)("div",{className:"order-stats-module__completedToday__EDiJI",children:[(0,s.jsx)("h3",{className:"order-stats-module__todayTitle__GWnz5",children:"Выполнено за сегодня:"}),(0,s.jsx)("div",{className:"order-stats-module__todayNumber__LGApR",children:n(t)})]})]})},c=d(442),l=d(9204),i=d(7873),_=d(6731);var u=function(){var e=(0,l.jL)(),r=(0,t.Zp)(),d=(0,t.zy)(),u=(0,a.useState)(!1),m=u[0],h=u[1],x=(0,a.useState)(null),f=x[0],j=x[1],p=(0,a.useRef)(!1),v=(0,l.GV)(i.IN),N=(0,l.GV)(i.$p),g=(0,l.GV)(i.ME),w=(0,l.GV)(i.FN),b=(0,l.GV)(i.xX),T=(0,l.GV)(i.T9),k=((0,l.GV)(i.g7),(0,l.GV)(_.vm));if((0,a.useEffect)((function(){var e;if(T&&f){var r=Date.now()-f;r>=5e3?h(!0):e=setTimeout((function(){h(!0)}),5e3-r)}else T||h(!1);return function(){e&&clearTimeout(e)}}),[T,f]),(0,a.useEffect)((function(){return j(Date.now()),h(!1),p.current=!1,p.current||(p.current=!0,console.log("[Feed] Connecting to WebSocket..."),e((0,i.aA)("wss://norma.nomoreparties.space/orders/all"))),function(){console.log("[Feed] Disconnecting from WebSocket..."),e((0,i.Xm)()),p.current=!1}}),[e]),b&&0===v.length)return(0,s.jsx)(c.a,{text:"Загрузка ленты заказов...",size:"large"});if(m&&T)return(0,s.jsxs)("div",{className:"feed-module__error__4wf6d",children:[(0,s.jsx)("h2",{children:"Ошибка загрузки ленты заказов"}),(0,s.jsx)("p",{children:T}),(0,s.jsx)("button",{onClick:function(){j(Date.now()),h(!1),p.current=!1,p.current||(p.current=!0,e((0,i.aA)("wss://norma.nomoreparties.space/orders/all")))},children:"Попробовать снова"})]});var S=w.done.map((function(e){return e.number})),y=w.pending.map((function(e){return e.number}));return(0,s.jsxs)("div",{className:"feed-module__feedPage__yF7Qh",children:[(0,s.jsx)("div",{className:"feed-module__header__VmaYE",children:(0,s.jsx)("h1",{className:"feed-module__title__CTVmw",children:"Лента заказов"})}),(0,s.jsxs)("div",{className:"feed-module__content__flymH",children:[(0,s.jsx)("div",{className:"feed-module__ordersSection__gWMzt",children:(0,s.jsx)("div",{className:"feed-module__ordersList__ETu12",children:v.map((function(e){return(0,s.jsx)(n.B,{order:e,ingredients:k,showStatus:!1,onClick:function(){return s=e.number,void r("/feed/".concat(s),{state:{backgroundLocation:d}});var s}},e._id)}))})}),(0,s.jsx)("div",{className:"feed-module__statsSection__Nc3Q3",children:(0,s.jsx)(o,{doneOrders:S,pendingOrders:y,totalCompleted:N,todayCompleted:g})})]})]})}}}]);